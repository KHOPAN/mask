<!DOCTYPE html><html><head><title>Mask</title><style>body{background-color:#202020;}p,button{font-family:"Consolas",monospace,sans-serif;font-weight:bold;font-size:1em;color:#FFFFFF;}button{font-size:0.82em;background-color:#2D2D2D;border-color:#353535;border-radius:0.4em;border-style:solid;min-width:5em;width:fit-content;height:2em;padding-left:0.8em;padding-right:0.8em;margin:0.2em;transition:all 0.1s;}button:hover{background-color:#323232;}button:active{color:#CECECE;background-color:#272727;border-color:#303030;}#webcam{margin-top:1em;}#predicted{color:#0E9FFF;}</style></head><body><p>Teachable Machine Image Model</p><button type="button" onclick="startModel()">Start</button><button type="button" onclick="window.location.reload()">Refresh</button><a href="https://www.github.com/KHOPAN/mask" target="_blank"><button type="button">View Sources</button></a><div id="webcam"></div><div id="label"></div><script src="https://cdn.jsdelivr.net/npm/@tensorflow/tfjs@latest/dist/tf.min.js"></script><script src="https://cdn.jsdelivr.net/npm/@teachablemachine/image@latest/dist/teachablemachine-image.min.js"></script><script>const BASE="https://raw.githubusercontent.com/KHOPAN/mask/refs/heads/main/internal/";let started=false;let label,model,webcam=null;let cases=0;async function startModel(){if(started){console.error("Camera already started.");alert("Error: The camera has already been started.");return;}started=true;label=document.getElementById("label");if((model=await tmImage.load(BASE+"model.json",BASE+"metadata.json"))==null){console.error("Variable 'model' is null.");alert("Error: The variable 'model' is null.");return;}for(let i=0;i<(cases=model.getTotalClasses());i++){label.appendChild(document.createElement("p"));}webcam=new tmImage.Webcam(200,200,true);await webcam.setup();await webcam.play();window.requestAnimationFrame(callback);document.getElementById("webcam").appendChild(webcam.canvas);}async function callback(){if(!started||label==null||model==null||cases<=0||webcam==null){console.error("No, this is not right. Why is everything null?");window.requestAnimationFrame(callback);return;}webcam.update();let result=await model.predict(webcam.canvas);if(result==null||!Array.isArray(result)){window.requestAnimationFrame(callback);return;}let longest=0;let highestProbability=0.0;let highestProbabilityElement=null;for(let i=0;i<cases;i++){longest=Math.max(longest,result[i].className.length);if(result[i].probability>highestProbability){highestProbability=result[i].probability;highestProbabilityElement=label.childNodes[i];}}for(let i=0;i<cases;i++){let approximate=result[i].probability.toFixed(3);let integer=Math.round(approximate*100.0);label.childNodes[i].innerHTML=result[i].className+("&nbsp".repeat(longest-result[i].className.length+1))+": "+approximate+" - "+("&nbsp".repeat(Math.max(0,2-Math.floor(Math.log10(Math.max(1,integer))))))+integer+"%";label.childNodes[i].id=(label.childNodes[i]==highestProbabilityElement)?"predicted":"";}window.requestAnimationFrame(callback);}</script></body></html>